// CHECK:
//   Mangled name: #test1(){}J<kotlin.String>
//   Public signature: /test1|8889900013954121507[0]
fun test1(): J<String> {
  return 
    // CHECK:
    //   Mangled name computed from Ir:         #test1(){}J<kotlin.String>#<anonymous>#static(kotlin.String?){}kotlin.String?
    //   Mangled name computed from Descriptor: #test1(){}J<kotlin.String>#<anonymous>#static(kotlin.String?){}kotlin.String?
    //   Mangled name computed from Fir:        could not compute mangled name: java.lang.IllegalStateException: unexpected element J@fun <anonymous>(x: R|kotlin/String!|): R|kotlin/String!| <inline=NoInline>  {... (truncated)
    local fun <anonymous>(x: @FlexibleNullability String?): @FlexibleNullability String? {
      return x
    }
 /*-> J<String> */
}

// CHECK:
//   Mangled name: #test2(){}J<kotlin.String?>
//   Public signature: /test2|-2485267088492515783[0]
fun test2(): J<@FlexibleNullability String?> {
  return 
    // CHECK:
    //   Mangled name computed from Ir:         #test2(){}J<kotlin.String?>#<anonymous>#static(kotlin.String){}kotlin.String?
    //   Mangled name computed from Descriptor: #test2(){}J<kotlin.String?>#<anonymous>#static(kotlin.String){}kotlin.String?
    //   Mangled name computed from Fir:        could not compute mangled name: java.lang.IllegalStateException: unexpected element J@fun <anonymous>(x: R|kotlin/String|): R|kotlin/String!| <inline=NoInline>  {... (truncated)
    local fun <anonymous>(x: String): @FlexibleNullability String? {
      return x
    }
 /*-> J<@FlexibleNullability String?> */
}

// CHECK:
//   Mangled name: #test3(){}
//   Public signature: /test3|-3759735065270951803[0]
fun test3() {
  return bar<@FlexibleNullability String?>(j = 
    // CHECK:
    //   Mangled name computed from Ir:         #test3(){}#<anonymous>#static(kotlin.String){}kotlin.String?
    //   Mangled name computed from Descriptor: #test3(){}#<anonymous>#static(kotlin.String){}kotlin.String?
    //   Mangled name computed from Fir:        could not compute mangled name: java.lang.IllegalStateException: unexpected element bar@fun <anonymous>(x: R|kotlin/String|): R|kotlin/String!| <inline=NoInline>  {... (truncated)
    local fun <anonymous>(x: String): @FlexibleNullability String? {
      return x
    }
 /*-> @FlexibleNullability J<@FlexibleNullability String?>? */)
}

// CHECK:
//   Mangled name: #test4(kotlin.Any){}
//   Public signature: /test4|-9023258848991787985[0]
fun test4(a: Any) {
  a as J<String> /*~> Unit */
  bar<@FlexibleNullability String?>(j = a /*as J<String> */)
}

// CHECK:
//   Mangled name: #test5(kotlin.Any){}
//   Public signature: /test5|4504681808078971124[0]
fun test5(a: Any) {
  a as Function1<String, String> /*~> Unit */
  bar<@FlexibleNullability String?>(j = a /*as Function1<String, String> */ /*-> @FlexibleNullability J<@FlexibleNullability String?>? */)
}

// CHECK:
//   Mangled name: #test6(kotlin.Function1<0:0,0:0>){0ยง<kotlin.Any?>}
//   Public signature: /test6|-3081320997310711341[0]
fun <T : Any?> test6(a: Function1<T, T>) {
  bar<@FlexibleNullability T?>(j = a /*-> @FlexibleNullability J<@FlexibleNullability T?>? */)
}

// CHECK:
//   Mangled name: #test7(kotlin.Any){0ยง<kotlin.Any?>}
//   Public signature: /test7|-5359981114052378429[0]
fun <T : Any?> test7(a: Any) {
  a as Function1<T, T> /*~> Unit */
  bar<@FlexibleNullability T?>(j = a /*as Function1<T, T> */ /*-> @FlexibleNullability J<@FlexibleNullability T?>? */)
}

// CHECK:
//   Mangled name: #test8(kotlin.Function1<kotlin.String,kotlin.String>){}J<kotlin.String?>
//   Public signature: /test8|-6112132748185879177[0]
fun test8(efn: @ExtensionFunctionType Function1<String, String>): J<@FlexibleNullability String?> {
  return efn /*-> J<@FlexibleNullability String?> */
}

// CHECK:
//   Mangled name: #test9(kotlin.Function1<kotlin.String,kotlin.String>){}
//   Public signature: /test9|5682079641444556672[0]
fun test9(efn: @ExtensionFunctionType Function1<String, String>) {
  bar<@FlexibleNullability String?>(j = efn /*-> @FlexibleNullability J<@FlexibleNullability String?>? */)
}

// CHECK:
//   Mangled name: #test10(kotlin.Function1<kotlin.Int,kotlin.String>){}
//   Public signature: /test10|3769162614537259024[0]
fun test10(fn: Function1<Int, String>) {
  bar2x<@FlexibleNullability Int?>(j2x = fn /*-> @FlexibleNullability J2X<@FlexibleNullability Int?>? */)
}

